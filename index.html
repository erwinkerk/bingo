<script>
    // Configuration for languages and their preferred voice patterns
    const words = {
        nl: { lang: 'nl-NL', u: ['', 'één', 'twee', 'drie', 'vier', 'vijf', 'zes', 'zeven', 'acht', 'negen'], t: ['tien', 'elf', 'twaalf', 'dertien', 'veertien', 'vijftien', 'zestien', 'zeventien', 'achttien', 'negentien'], d: ['', '', 'twintig', 'dertig', 'veertig', 'vijftig', 'zestig', 'zeventig', 'tachtig', 'negentig'] },
        en: { lang: 'en-GB', u: ['', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine'], t: ['ten', 'eleven', 'twelve', 'thirteen', 'fourteen', 'fifteen', 'sixteen', 'seventeen', 'eighteen', 'nineteen'], d: ['', '', 'twenty', 'thirty', 'forty', 'fifty', 'sixty', 'seventy', 'eighty', 'ninety'] },
        da: { lang: 'da-DK', u: ['', 'en', 'to', 'tre', 'fire', 'fem', 'seks', 'syv', 'otte', 'ni'], t: ['ti', 'elleve', 'tolv', 'tretten', 'fjorten', 'femten', 'seksten', 'sytten', 'atten', 'nitten'], d: ['', '', 'tyve', 'tredive', 'fyrre', 'halvtreds', 'tres', 'halvfjerds', 'firs', 'halvfems'] }
    };

    let voices = [];

    // --- NEW: Voice Selection Logic ---
    function loadVoices() {
        voices = window.speechSynthesis.getVoices();
    }

    // Chrome on Android loads voices asynchronously
    if (speechSynthesis.onvoiceschanged !== undefined) {
        speechSynthesis.onvoiceschanged = loadVoices;
    }

    function getBestVoice(langCode) {
        // Look for exact locale match, prefer 'Google' or 'Premium' voices on Android
        return voices.find(v => v.lang === langCode && v.name.includes('Google')) || 
               voices.find(v => v.lang.startsWith(langCode.split('-')[0])) || 
               null;
    }

    function speakWord(langKey) {
        const text = document.getElementById(`${langKey}-word`).innerText;
        if (!text || !window.speechSynthesis) return;

        window.speechSynthesis.cancel(); // Stop current

        const utterance = new SpeechSynthesisUtterance(text);
        const targetLang = words[langKey].lang;
        
        const selectedVoice = getBestVoice(targetLang);
        if (selectedVoice) {
            utterance.voice = selectedVoice;
        }

        utterance.lang = targetLang;
        utterance.pitch = 1.0; // Influence pitch (0.1 to 2)
        utterance.rate = 0.85;  // Influence speed (0.1 to 10)
        
        window.speechSynthesis.speak(utterance);
    }

    // ... (Keep the rest of the existing Bingo logic: drawNumber, renderGrid, etc.) ...
</script>
